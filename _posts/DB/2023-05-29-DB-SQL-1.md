---
title: "[DB]SQL(1)"
excerpt: "SQL"

categories:
  - DB
tags:
  - [데이터베이스, SQL]

toc: true
toc_sticky: true

date: 2023-05-29
---

## 📚SQL 개요
SQL(Structured Query Language)은 구조화된 질의 언어라는 의미를 가지고 사용자와 DBMS 간의 의사소통을 위한 언어입니다. RDBMS에서 데이터를 관리하기 위한 비절차적 언어이고 데이터베이스에서 원하는 정보를 간단명료하게 표현할 수 있는 선언형 언어입니다. SQL은 데이터에 대한 정의와 조작, 관리하는 역할에 따라 세 영역의 언어로 나뉩니다.

* 데이터 정의 언어(DDL): 데이터 정의 언어는 데이터베이스 내의 개체를 생성 및 삭제하고 그 구조를 조작하는 SQL문을 의미합니다. 테이블 스키마 정의, 테이블 삭제, 테이블 스키마 변경 등의 기능을 수행합니다.

* 데이터 조작 언어(DML): 데이터 조작 언어는 레코드 검색, 추가, 삭제 등의 실제 데이터 조작과 관련된 SQL문을 의미합니다. INSERT, UPDATE, DELETE, SELECT문과 같은 다양한 부가 기능을 제공합니다.

* 데이터 제어 언어(DCL): 데이터 제어 언어는 DBMS의 동작 설정 및 DBMS 접근에 대한 사용자 권한을 관리하는 SQL명령어 집합입니다. GRANT, REVOKE, BEGIN 등의 명령어로 구성되고, 주로 데이터베이스 관리자(DBA)가 사용합니다.

<br><br><br>

## 📚데이터 정의 언어
SQL의 데이터 정의 언어는 테이블에 대한 정보뿐만 아니라 테이블의 스키마, 컬럼들의 데이터 타입, 제약조건, 색인 구조 등의 데이터베이스 객체를 정의합니다.

| 종류 | 적용 | 기능 |
| :---: | :---: | :---: |
| CREATE | SCHEMA | 스키마 생성 |
| CREATE | TABLE | 테이블 생성 |
| CREATE | INDEX | 인덱스 생성 |
| CREATE | VIEW | 뷰 생성 |
| ALTER | SCHEMA | 스키마 수정 |
| ALTER | TABLE | 테이블 수정 |
| DROP | SCHEMA | 스키마 삭제 |
| DROP | TABLE | 테이블 삭제 |
| DROP | INDEX | 인덱스 삭제 |
| DROP | VIEW | 뷰 삭제 |

<br>

### 📄스키마 정의
DDL문으로 생성 가능한 가장 상위 단계의 개체는 스키마입니다. 스키마는 MySQL에서 데이터베이스를 의미합니다. 스키마 생성에는 두 가지 방법이 있습니다.

1. MySQL 워크벤치 Forward Engineer 기능을 이용하여 자동적으로 스키마와 테이블을 생성

2. MySQL 워크벤치 SQL 패널에서 스키마 생성문 입력

<br>

* 스키마 생성
```sql
CREATE SCHEMA 스키마 이름
```

<br>


* 스키마 삭제
```sql
DROP SCHEMA 스키마 이름
```

DROP SCHEMA문을 이용하면 스키마 내부의 모든 데이터가 같이 삭제됩니다.

<br><br>

### 📄테이블 정의
테이블은 관계형 모델의 릴레이션에 대응되는 구조입니다. DBMS에서 가장 기본적인 데이터 저장구조인 테이블은 CREATE TABLE문을 사용하여 정의됩니다. 테이블의 이름, 각각의 컬럼에 대한 컬럼의 이름, 데이터 타입, 제약조건을 써서 새로운 데이블을 정의합니다.

* 테이블 생성
<br>
```sql
CREATE TABLE 테이블 이름(
  컬럼 데이터타입 [제약조건]
  컬럼 데이터타입 [제약조건]
  ...

  [PRIMARY KEY 컬럼]
  [UNIQUE 컬럼]
  [FOREIGN KEY 컬럼 REFERENCES 테이블(컬럼)]
)
```

<br>

* 데이터 타입
<br>
테이블을 정의할 때 각각의 컬럼에 저장될 수 있는 데이터 타입을 명시해야 합니다. 데이터 타입은 컬럼에 저장되는 값의 종류를 말합니다.

| 종류 | 데이터 타입 | 기능 |
| :---: | :---: | :---: |
| 정수 | TINYINT | -128~127 사이의 정수 |
| 정수 | SMALLINT | -32,768~32,767 사이의 정수 |
| 정수 | MEDIUMINT | -8,388,608~8,388,607 사이의 정수 |
| 정수 | INT | -2,147,483,648~2,147,483,647 사이의 정수 |
| 정수 | BIGINT | -9,223,372,036,854,775,808~9,223,372,036,854,775,8087 사이의 정수 |
| 고정 소수형 | DECIMAL | 십진수를 표현 |
| 고정 소수형 | NUMERIC | DECIMAL과 동일 |
| 부동 소수형 | FLOAT | 4byte 크기를 갖는 부동 소수 |
| 부동 소수형 | FLOAT(P) | 유효숫자를 저장하기 위한 자릿수가 P개인 부동 소수 |
| 부동 소수형 | DOUBLE | 8byte의 크기를 갖는 부동 소수 |
| 문자 | CHAR(n) | 길이가 n으로 고정된 문자열 |
| 문자 | VARCHAR(n) | 최대 n개로 구성된 가변길이 문자열 |
| 문자 | TEXT | 길이가 긴 가변길이 문자열 |
| 문자 | ENUM | 유한 개의 문자열 집합 중 하나의 값을 선택 |
| 날짜/시간 | DATE | 'CCYY-MM-DD' |
| 날짜/시간 | TIME | '00:00:00' |
| 날짜/시간 | DATETIME | 'CCYY-MM-DD 00:00:00', 항상 일정 |
| 날짜/시간 | TIMESTAMP | 'CCYY-MM-DD 00:00:00', MySQL 서버의 타임존에 따라 변경 |
| 날짜/시간 | YEAR | 'CCYY' |

<br>

* 테이블 수정
<br>
'ALTER TABLE 테이블이름'은 필수 입력 사항입니다. 하나 이상의 ADD COLUMN, DROP COLUMN, CHANGE COLUMN, MODIFY COLUM을 적용해야하고 동시에 여러 명령을 적용할 수 있습니다.

```sql
ALTER TABLE 테이블 이름
  /* 주어진 컬럼 이름과 데이터 타입에 해당하는 
   새로운 컬럼 추가 */
  [ADD COLUMN 컬럼 데이터타임[제약조건]]

  -- 지정된 컬럼을 테이블에서 삭제
  [DROP COLUMN 컬럼, ...]

  -- 컬럼의 이름이나 데이터 타입 또는 제약조건을 변경
  [CHANGE COLUMN 수정전컬럼, 수정후컬럼]

  -- 컬럼의 데이터 타입 변경
  [MODIFY COLUMN 컬럼 새로운_데이터타입]
```

<br>

* 테이블 삭제
<br>

```sql
DROP TABLE 테이블 이름
```

<br><br>

### 📄제약조건 사용
테이블과 테이블의 컬럼을 세밀하게 관리하고자 할 때 제약조건을 이용하여 중복되는 레코드 삽입을 막거나, 값이 NULL이 아닌 값이 필수로 입력되도록 설정할 수 있습니다.

* PRIMARY KEY 절
<br>
PRIMARY KEY 절은 기본키를 지정하는 제약조건입니다. 하나 이상의 컬럼을 기본키로 설정할 수 있습니다. 특정 컬럼에 기본키 조건을 정의하면 테이블의 모든 레코드는 해당 컬럼에 대해 고유한 값을 가져야 하고, NULL 값은 입력할 수 없습니다.

<br>

* NOT NULL 절
<br>
NOT NULL 절은 NN 절이라고도 합니다. NOT NULL 제약조건은 특정 컬럼을 정의하면 모든 레코드들은 해당 컬럼에 반드시 어떤 값이 저장되어야 합니다.

<br>

* UNIQUE 절
<br>
UNIQUE 절은 특정 컬럼에 제약 조건을 정의하면 어떤 레코드들도 해당 컬럼에 대해 다른 레코드와 동일한 값을 가질 수 없습니다.

<br>

* AUTO_INCREMENT 절
<br>
AUTO_INCREMENT 절은 사용자가 직접 입력하지 않아도 레코드가 추가될 때 자동적으로 기존 레코드의 값을 참고하여 순차적으로 해당 컬럼에 1을 증가시킨 값을 저장합니다. INT 계열의 데이터 타입에만 적용할 수 있습니다.

<br>

* DEFAULT 절
<br>
DEFAULT 절은 해당 컬럼에 어떤 값이 입력되지 않으면 자동으로 지정된 값이 입력되도록 하는 조건입니다.

<br>

* FOREIGN KEY 절
<br>
다른 컬럼을 참조하는 외래키를 정의합니다. 외래키 제약조건을 정의하기 위해 참조하는 테이블 컬럼과 참조되는 테이블 컬럼이 필요한데, 참조하는 컬럼의 값이 참조되는 컬럼에 존재하지 않을 경우 참조 무결성 제약조건에 의해 DBMS 실행을 거절합니다.

```sql
FOREIGN KEY (참조하는 컬럼이름)
  REFERENCES 참조되는 테이블이름(참조되는 컬럼이름)
```

<br>

* CHECK 절
<br>
테이블 생성 시 컬럼값이 특정 조건을 준수하여 데이터 무결성을 유지하기 위해 CHECK절을 제공합니다. 해당 컬럼이 조건을 준수하지 않을 경우 레코드 삽입 또는 수정을 거절합니다. MySQL 서버 8.X 이하 버전은 CHECK 절을 지원하지 않습니다.

```sql
CHECK (조건)

--또는

CONSTRAINT id CHECK (조건)
```

<br><br>